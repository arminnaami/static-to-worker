{"title":"把 Apps Script 作為簡單的資料庫來使用","slug":"apps-script-db","date":"2018-04-01T09:00:12.000Z","updated":"2019-08-16T11:14:47.536Z","comments":true,"path":"api/articles/apps-script-db.json","excerpt":"Apps Script 是 Google 所提供的免費服務之一<br>可以在上面執行 javascript 的子集與 Google 的去操作一些服務(ex: 雲端硬碟、試算表)<br>而他也支援使用 httphook ，可以在收到某些 request 時做出某些操作而 maple3142/apps-script-db 就是使用它的一些功能來實現 key=&gt;value 的資料庫的小 library","covers":["newscript.png","pasteandsave.png","deploy.png","editor.png"],"content":"<p><a href=\"https://script.google.com/\" target=\"_blank\" rel=\"noopener\">Apps Script</a> 是 Google 所提供的免費服務之一<br>可以在上面執行 javascript 的子集與 Google 的去操作一些服務(ex: 雲端硬碟、試算表)<br>而他也支援使用 httphook ，可以在收到某些 request 時做出某些操作</p>\n<p>而 <a href=\"https://github.com/maple3142/apps-script-db\" target=\"_blank\" rel=\"noopener\">maple3142/apps-script-db</a> 就是使用它的一些功能來實現 key=&gt;value 的資料庫的小 library</p>\n<a id=\"more\"></a>\n\n<h1 id=\"建立資料庫\"><a href=\"#建立資料庫\" class=\"headerlink\" title=\"建立資料庫\"></a>建立資料庫</h1><h2 id=\"建立第一個腳本\"><a href=\"#建立第一個腳本\" class=\"headerlink\" title=\"建立第一個腳本\"></a>建立第一個腳本</h2><p>到 <a href=\"https://script.google.com/home\" target=\"_blank\" rel=\"noopener\">Apps Script 官網</a> 上登入你的 Google 帳號，按下右上角的新增指令碼</p>\n<p><img src=\"newscript.png\" alt=\"new script\"></p>\n<p>接下來把 <a href=\"https://raw.githubusercontent.com/maple3142/apps-script-db/master/db.js\" target=\"_blank\" rel=\"noopener\">db.js</a> 裡面的內容複製到剛剛建立的新腳本中<br>然後點右上角的 <code>檔案</code>-&gt;<code>儲存</code>，或是直接按下 <code>Ctrl+S</code> 來儲存檔案，然後輸入任何能夠辨識的名稱</p>\n<p><img src=\"pasteandsave.png\" alt=\"paste and save\"></p>\n<blockquote>\n<p>應該要看到這樣</p>\n</blockquote>\n<h2 id=\"發佈\"><a href=\"#發佈\" class=\"headerlink\" title=\"發佈\"></a>發佈</h2><p>接下來按上方選單的 <code>發佈</code>-&gt;<code>部屬為網路應用程式</code><br>然後在 <code>專案版本</code> 中輸入任何東西<br>以及把 <code>具有應用程式存取權的使用者</code> 改成 <code>任何人，甚至是匿名使用者</code></p>\n<p><img src=\"deploy.png\" alt=\"deploy\"></p>\n<p>然後按下確定之後會得到一個網址，這個網址就是你的資料庫位置</p>\n<blockquote>\n<p>網址應該長的像下面這樣</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://script.google.com/macros/s/隨機字串/exec</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h1><p>目前這個專案也只有 javascript 的 api 能呼叫，不過實際上用任何能發送 http request 的語言都能操作資料庫<br>建議參考 <a href=\"https://github.com/maple3142/apps-script-db/blob/master/src/index.js\" target=\"_blank\" rel=\"noopener\">index.js</a> 裡面的內容</p>\n<blockquote>\n<p>真的很簡單，不到 50 行</p>\n</blockquote>\n<h2 id=\"UI-編輯器\"><a href=\"#UI-編輯器\" class=\"headerlink\" title=\"UI 編輯器\"></a>UI 編輯器</h2><p>到 <a href=\"https://maple3142.github.io/apps-script-db/\" target=\"_blank\" rel=\"noopener\">https://maple3142.github.io/apps-script-db/</a> 能看到一個頁面<br>在 <code>資料庫網址</code> 的欄位填上剛剛得到的資料庫網址，並按下 <code>載入</code><br>然後可以新增一些 key 值與更新一些 value</p>\n<p><img src=\"editor.png\" alt=\"editor\"></p>\n<p>而這個編輯器的原始碼在這個專案的 <a href=\"https://github.com/maple3142/apps-script-db/tree/webui\" target=\"_blank\" rel=\"noopener\">webui</a> branch</p>\n<h2 id=\"node-js\"><a href=\"#node-js\" class=\"headerlink\" title=\"node.js\"></a>node.js</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i --save apps-script-db</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> ADB = <span class=\"built_in\">require</span>(<span class=\"string\">'apps-script-db'</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> fetch = <span class=\"built_in\">require</span>(<span class=\"string\">'node-fetch'</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> db = <span class=\"keyword\">new</span> ADB(YOUR_DATABASE_URL, fetch)</span><br><span class=\"line\"></span><br><span class=\"line\">(<span class=\"keyword\">async</span> ()=&gt;&#123;</span><br><span class=\"line\">  <span class=\"keyword\">await</span> db.set(<span class=\"string\">'key'</span>, &#123;<span class=\"attr\">a</span>: <span class=\"number\">5</span>&#125;)</span><br><span class=\"line\">  <span class=\"keyword\">await</span> db.get(<span class=\"string\">'key'</span>) <span class=\"comment\">//&#123;a: 5&#125;</span></span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n\n<p>因為這是使用 <code>fetch</code> 去發送請求的，所以需要自己提供 fetch 的 polyfill<br>不內建是因為為了減少瀏覽器打包的問題</p>\n<h2 id=\"瀏覽器\"><a href=\"#瀏覽器\" class=\"headerlink\" title=\"瀏覽器\"></a>瀏覽器</h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://unpkg.com/apps-script-db\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"keyword\">const</span> db = <span class=\"keyword\">new</span> ADB(YOUR_DATABASE_URL)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在瀏覽器端能直接從 cdn 上引用<br>不過也可以用 webpack 之類的東西來 require (一樣不需要手動提供 fetch)</p>\n","more":"<h1 id=\"建立資料庫\"><a href=\"#建立資料庫\" class=\"headerlink\" title=\"建立資料庫\"></a>建立資料庫</h1><h2 id=\"建立第一個腳本\"><a href=\"#建立第一個腳本\" class=\"headerlink\" title=\"建立第一個腳本\"></a>建立第一個腳本</h2><p>到 <a href=\"https://script.google.com/home\" target=\"_blank\" rel=\"noopener\">Apps Script 官網</a> 上登入你的 Google 帳號，按下右上角的新增指令碼</p>\n<p><img src=\"newscript.png\" alt=\"new script\"></p>\n<p>接下來把 <a href=\"https://raw.githubusercontent.com/maple3142/apps-script-db/master/db.js\" target=\"_blank\" rel=\"noopener\">db.js</a> 裡面的內容複製到剛剛建立的新腳本中<br>然後點右上角的 <code>檔案</code>-&gt;<code>儲存</code>，或是直接按下 <code>Ctrl+S</code> 來儲存檔案，然後輸入任何能夠辨識的名稱</p>\n<p><img src=\"pasteandsave.png\" alt=\"paste and save\"></p>\n<blockquote>\n<p>應該要看到這樣</p>\n</blockquote>\n<h2 id=\"發佈\"><a href=\"#發佈\" class=\"headerlink\" title=\"發佈\"></a>發佈</h2><p>接下來按上方選單的 <code>發佈</code>-&gt;<code>部屬為網路應用程式</code><br>然後在 <code>專案版本</code> 中輸入任何東西<br>以及把 <code>具有應用程式存取權的使用者</code> 改成 <code>任何人，甚至是匿名使用者</code></p>\n<p><img src=\"deploy.png\" alt=\"deploy\"></p>\n<p>然後按下確定之後會得到一個網址，這個網址就是你的資料庫位置</p>\n<blockquote>\n<p>網址應該長的像下面這樣</p>\n</blockquote>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">https://script.google.com/macros/s/隨機字串/exec</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h1><p>目前這個專案也只有 javascript 的 api 能呼叫，不過實際上用任何能發送 http request 的語言都能操作資料庫<br>建議參考 <a href=\"https://github.com/maple3142/apps-script-db/blob/master/src/index.js\" target=\"_blank\" rel=\"noopener\">index.js</a> 裡面的內容</p>\n<blockquote>\n<p>真的很簡單，不到 50 行</p>\n</blockquote>\n<h2 id=\"UI-編輯器\"><a href=\"#UI-編輯器\" class=\"headerlink\" title=\"UI 編輯器\"></a>UI 編輯器</h2><p>到 <a href=\"https://maple3142.github.io/apps-script-db/\" target=\"_blank\" rel=\"noopener\">https://maple3142.github.io/apps-script-db/</a> 能看到一個頁面<br>在 <code>資料庫網址</code> 的欄位填上剛剛得到的資料庫網址，並按下 <code>載入</code><br>然後可以新增一些 key 值與更新一些 value</p>\n<p><img src=\"editor.png\" alt=\"editor\"></p>\n<p>而這個編輯器的原始碼在這個專案的 <a href=\"https://github.com/maple3142/apps-script-db/tree/webui\" target=\"_blank\" rel=\"noopener\">webui</a> branch</p>\n<h2 id=\"node-js\"><a href=\"#node-js\" class=\"headerlink\" title=\"node.js\"></a>node.js</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm i --save apps-script-db</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> ADB = <span class=\"built_in\">require</span>(<span class=\"string\">'apps-script-db'</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> fetch = <span class=\"built_in\">require</span>(<span class=\"string\">'node-fetch'</span>)</span><br><span class=\"line\"><span class=\"keyword\">const</span> db = <span class=\"keyword\">new</span> ADB(YOUR_DATABASE_URL, fetch)</span><br><span class=\"line\"></span><br><span class=\"line\">(<span class=\"keyword\">async</span> ()=&gt;&#123;</span><br><span class=\"line\">  <span class=\"keyword\">await</span> db.set(<span class=\"string\">'key'</span>, &#123;<span class=\"attr\">a</span>: <span class=\"number\">5</span>&#125;)</span><br><span class=\"line\">  <span class=\"keyword\">await</span> db.get(<span class=\"string\">'key'</span>) <span class=\"comment\">//&#123;a: 5&#125;</span></span><br><span class=\"line\">&#125;)()</span><br></pre></td></tr></table></figure>\n\n<p>因為這是使用 <code>fetch</code> 去發送請求的，所以需要自己提供 fetch 的 polyfill<br>不內建是因為為了減少瀏覽器打包的問題</p>\n<h2 id=\"瀏覽器\"><a href=\"#瀏覽器\" class=\"headerlink\" title=\"瀏覽器\"></a>瀏覽器</h2><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">src</span>=<span class=\"string\">\"https://unpkg.com/apps-script-db\"</span>&gt;</span><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"undefined\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"keyword\">const</span> db = <span class=\"keyword\">new</span> ADB(YOUR_DATABASE_URL)</span></span><br><span class=\"line\"><span class=\"undefined\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>在瀏覽器端能直接從 cdn 上引用<br>不過也可以用 webpack 之類的東西來 require (一樣不需要手動提供 fetch)</p>","categories":[{"name":"專案","path":"api/categories/專案.json"}],"tags":[{"name":"javascript","path":"api/tags/javascript.json"},{"name":"appsscript","path":"api/tags/appsscript.json"},{"name":"free","path":"api/tags/free.json"}]}